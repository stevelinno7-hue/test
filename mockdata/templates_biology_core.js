(function(global){
    'use strict';
    console.log("ğŸ§¬ [Biology V9.0] ç”Ÿç‰©æ ¸å¿ƒé¡Œåº« (ç´°èƒ/ç”Ÿç†/éºå‚³/ç”Ÿæ…‹) å•Ÿå‹•...");

    window.__BIOLOGY_REPO__ = window.__BIOLOGY_REPO__ || {};
    const Utils = { shuffle: (arr) => arr.sort(() => Math.random() - 0.5) };

    const bioDB = [
        // ç´°èƒ
        {q:"æ¤ç‰©ç´°èƒç‰¹æœ‰ï¼Œèƒ½é€²è¡Œå…‰åˆä½œç”¨çš„æ§‹é€ ï¼Ÿ", a:"è‘‰ç¶ é«”", o:["ç²’ç·šé«”","ç´°èƒå£","æ¶²æ³¡"], t:"ç´°èƒ"},
        {q:"è¢«ç¨±ç‚ºç´°èƒçš„èƒ½é‡å·¥å» ï¼Œè² è²¬å‘¼å¸ä½œç”¨çš„æ˜¯ï¼Ÿ", a:"ç²’ç·šé«”", o:["æ ¸ç³–é«”","é«˜åŸºæ°é«”","è‘‰ç¶ é«”"], t:"ç´°èƒ"},
        {q:"æ§åˆ¶ç´°èƒç”Ÿç†æ´»å‹•çš„ä¸­æ¨æ˜¯ï¼Ÿ", a:"ç´°èƒæ ¸", o:["ç´°èƒè³ª","ç´°èƒè†œ","æ¶²æ³¡"], t:"ç´°èƒ"},
        
        // ç”Ÿç† (äººé«”)
        {q:"äººé«”è² è²¬éæ¿¾è¡€æ¶²ã€å½¢æˆå°¿æ¶²çš„å™¨å®˜ï¼Ÿ", a:"è…è‡Ÿ", o:["è‚è‡Ÿ","è†€èƒ±","å¤§è…¸"], t:"æ’æ³„"},
        {q:"äººé«”æœ€å¤§çš„æ¶ˆåŒ–è…ºï¼Œå¯åˆ†æ³Œè†½æ±çš„æ˜¯ï¼Ÿ", a:"è‚è‡Ÿ", o:["èƒ°è‡Ÿ","è†½å›Š","èƒƒ"], t:"æ¶ˆåŒ–"},
        {q:"è² è²¬å°‡å……æ°§è¡€è¼¸é€åˆ°å…¨èº«çš„è¡€ç®¡æ˜¯ï¼Ÿ", a:"ä¸»å‹•è„ˆ", o:["è‚ºå‹•è„ˆ","ä¸Šå¤§éœè„ˆ","è‚ºéœè„ˆ"], t:"å¾ªç’°"},
        {q:"é‡åˆ°ç·Šæ€¥ç‹€æ³æ™‚ï¼Œåˆ†æ³Œå“ªç¨®æ¿€ç´ ä½¿å¿ƒè·³åŠ é€Ÿï¼Ÿ", a:"è…ä¸Šè…ºç´ ", o:["èƒ°å³¶ç´ ","ç”Ÿé•·æ¿€ç´ ","ç”²ç‹€è…ºç´ "], t:"å…§åˆ†æ³Œ"},
        {q:"ç¥ç¶“ç³»çµ±çš„åŸºæœ¬å–®ä½æ˜¯ï¼Ÿ", a:"ç¥ç¶“å…ƒ", o:["å—å™¨","å‹•å™¨","è…¦"], t:"ç¥ç¶“"},

        // éºå‚³èˆ‡æ¼”åŒ–
        {q:"äººé¡ä¸€èˆ¬é«”ç´°èƒå…·æœ‰å¹¾æ¢æŸ“è‰²é«”ï¼Ÿ", a:"46æ¢", o:["23æ¢","44æ¢","48æ¢"], t:"éºå‚³"},
        {q:"æå‡ºã€Œå¤©æ“‡èªªã€ä¾†è§£é‡‹ç”Ÿç‰©æ¼”åŒ–çš„äººæ˜¯ï¼Ÿ", a:"é”çˆ¾æ–‡", o:["æ‹‰é¦¬å…‹","å­Ÿå¾·çˆ¾","æ—å¥ˆ"], t:"æ¼”åŒ–"},
        {q:"æ±ºå®šæ€§ç‹€è¡¨ç¾çš„ç‰‡æ®µ DNA ç¨±ç‚ºï¼Ÿ", a:"åŸºå› ", o:["æŸ“è‰²é«”","æ ¸è‹·é…¸","è›‹ç™½è³ª"], t:"éºå‚³"},

        // ç”Ÿæ…‹èˆ‡æ¤ç‰©
        {q:"åœ¨é£Ÿç‰©éˆä¸­ï¼Œç¶ è‰²æ¤ç‰©é€šå¸¸æ‰®æ¼”ä»€éº¼è§’è‰²ï¼Ÿ", a:"ç”Ÿç”¢è€…", o:["æ¶ˆè²»è€…","åˆ†è§£è€…","æ¸…é™¤è€…"], t:"ç”Ÿæ…‹"},
        {q:"æ¤ç‰©é«”å…§é‹è¼¸æ°´åˆ†çš„æ§‹é€ æ˜¯ï¼Ÿ", a:"æœ¨è³ªéƒ¨", o:["éŸŒçš®éƒ¨","å½¢æˆå±¤","è¡¨çš®"], t:"æ¤ç‰©"},
        {q:"æ¤ç‰©æ°£å­”çš„ä¸»è¦åŠŸèƒ½æ˜¯ï¼Ÿ", a:"æ°£é«”äº¤æ›èˆ‡è’¸æ•£", o:["å¸æ”¶æ°´åˆ†","å…‰åˆä½œç”¨","æ”¯æ’æ¤ç‰©"], t:"æ¤ç‰©"},
        {q:"ä¸‹åˆ—ä½•è€…å±¬æ–¼åˆ†è§£è€…ï¼Ÿ", a:"é»´èŒ", o:["è—ç¶ èŒ","èš¯èš“","ç¦¿é·¹"], t:"ç”Ÿæ…‹"}
    ];

    // ç‚ºæ¯é¡Œç”Ÿæˆ 2 ç¨®è®Šé«”ï¼Œç¸½è¨ˆ 30 é¡Œä»¥ä¸Š
    bioDB.forEach((item, idx) => {
        const id = `bio_core_${idx}`;
        const tags = ["biology", "ç”Ÿç‰©", item.t, "åœ‹ä¸ƒ"];
        
        const func = () => {
            const opts = Utils.shuffle([item.a, ...item.o]);
            return {
                question: `ã€${item.t}ã€‘${item.q}`,
                options: opts,
                answer: opts.indexOf(item.a),
                explanation: [`æ­£ç¢ºç­”æ¡ˆï¼š${item.a}`, ``],
                subject: "biology", tags: tags
            };
        };
        window.__BIOLOGY_REPO__[id] = { func, tags, subject: "biology" };
    });

    // é¡å¤–ç”Ÿæˆé…å°é¡Œ
    bioDB.forEach((item, idx) => {
        const id = `bio_match_${idx}`;
        const tags = ["biology", "ç”Ÿç‰©", item.t, "åœ‹ä¸ƒ"];
        window.__BIOLOGY_REPO__[id] = {
            func: () => {
                const others = Utils.shuffle(bioDB.filter(x=>x.a!==item.a)).slice(0,3).map(x=>x.a);
                const opts = Utils.shuffle([item.q, ...others.map(a=>bioDB.find(x=>x.a===a).q)]); // é€™æ˜¯æŠŠé¡Œç›®ç•¶é¸é …
                return {
                    question: `ã€${item.t}ã€‘é—œæ–¼ã€Œ${item.a}ã€çš„æ•˜è¿°ï¼Œä¸‹åˆ—ä½•è€…æ­£ç¢ºï¼Ÿ`,
                    options: opts,
                    answer: opts.indexOf(item.q),
                    explanation: [`${item.a}: ${item.q}`, ``],
                    subject: "biology", tags: tags
                };
            }, tags, subject: "biology"
        };
    });

})(window);
