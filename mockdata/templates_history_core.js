(function(global){
    'use strict';
    console.log("ğŸ“œ [History V8.5] æ­·å²æ ¸å¿ƒè³‡æ–™åº«å•Ÿå‹•...");
    
    window.__HISTORY_REPO__ = window.__HISTORY_REPO__ || {};

    const Utils = {
        shuffle: (arr) => arr.sort(() => Math.random() - 0.5),
        getImg: (t) => ``
    };

    const historyDB = [
        // [åœ‹ä¸ƒ] å°ç£å²
        { t:["åœ‹ä¸ƒ","å°ç£å²"], e:"è·æ²»æ™‚æœŸ", y:"è½‰å£è²¿æ˜“", k:"ç†±è˜­é®åŸ", d:"è·è˜­äººä»¥å°ç£ç‚ºæ“šé»ï¼Œç™¼å±•å°ä¸­åœ‹èˆ‡æ—¥æœ¬çš„è½‰å£è²¿æ˜“ã€‚" },
        { t:["åœ‹ä¸ƒ","å°ç£å²"], e:"é„­æ°æ™‚æœŸ", y:"åæ¸…å¾©æ˜", k:"å…¨å°é¦–å­¸", d:"é„­æˆåŠŸæ”»å°å»ºç«‹æ”¿æ¬Šï¼Œä»¥åæ¸…å¾©æ˜ç‚ºç›®æ¨™ï¼Œé™³æ°¸è¯å»ºç«‹å­”å»Ÿã€‚" },
        { t:["åœ‹ä¸ƒ","å°ç£å²"], e:"æ¸…é ˜å‰æœŸ", y:"æ¸¡å°ç¦ä»¤", k:"ç¾…æ¼¢è…³", d:"æ¸…æœåˆæœŸé™åˆ¶ç§»æ°‘ï¼Œå°è‡´å°ç£ç¤¾æœƒç”·å¤šå¥³å°‘ï¼Œç¾…æ¼¢è…³çœ¾å¤šã€‚" },
        { t:["åœ‹ä¸ƒ","å°ç£å²"], e:"é–‹æ¸¯é€šå•†", y:"èŒ¶ç³–æ¨Ÿè…¦", k:"æ´‹è¡Œ", d:"å¤©æ´¥æ¢ç´„å¾Œå°ç£é–‹æ¸¯ï¼ŒèŒ¶ã€ç³–ã€æ¨Ÿè…¦æˆç‚ºä¸»è¦å‡ºå£å“ã€‚" },
        { t:["åœ‹ä¸ƒ","å°ç£å²"], e:"æ—¥æ²»æ™‚æœŸ", y:"çš‡æ°‘åŒ–é‹å‹•", k:"æ”¹å§“å", d:"ä¸­æ—¥æˆ°çˆ­çˆ†ç™¼å¾Œï¼Œæ¨å‹•èªªæ—¥èªã€æ”¹å§“åç­‰çš‡æ°‘åŒ–æ”¿ç­–ã€‚" },
        { t:["åœ‹ä¸ƒ","å°ç£å²"], e:"åå¤§å»ºè¨­", y:"ç¶“æ¿Ÿèµ·é£›", k:"è”£ç¶“åœ‹", d:"1970å¹´ä»£æ¨å‹•åŸºç¤å»ºè¨­ï¼Œå¥ å®šå°ç£å·¥æ¥­åŒ–åŸºç¤ã€‚" },

        // [åœ‹å…«] ä¸­åœ‹å²
        { t:["åœ‹å…«","ä¸­åœ‹å²"], e:"ç§¦å§‹çš‡", y:"ä¸­å¤®é›†æ¬Š", k:"å…µé¦¬ä¿‘", d:"å»¢å°å»ºè¡Œéƒ¡ç¸£ï¼Œçµ±ä¸€æ–‡å­—åº¦é‡è¡¡ï¼Œä¿®ç¯‰é•·åŸã€‚" },
        { t:["åœ‹å…«","ä¸­åœ‹å²"], e:"æ¼¢æ­¦å¸", y:"ç¨å°Šå„’è¡“", k:"çµ²è·¯", d:"ç½·é»œç™¾å®¶ç¨å°Šå„’è¡“ï¼Œæ´¾å¼µé¨«é€šè¥¿åŸŸï¼Œé–‹é—¢çµ²è·¯ã€‚" },
        { t:["åœ‹å…«","ä¸­åœ‹å²"], e:"å”æœ", y:"å¤©å¯æ±—", k:"æ–‡åŒ–äº¤æµ", d:"åœ‹åŠ›å¼·ç››ï¼Œå‘¨é‚Šåœ‹å®¶å°Šç¨±å”å¤ªå®—ç‚ºå¤©å¯æ±—ï¼Œæ–‡åŒ–å…¼å®¹ä¸¦è“„ã€‚" },
        { t:["åœ‹å…«","ä¸­åœ‹å²"], e:"å®‹æœ", y:"é‡æ–‡è¼•æ­¦", k:"æ´»å­—å°åˆ·", d:"è§£æ±ºè—©é®å‰²æ“šå•é¡Œï¼Œå°è‡´è»äº‹ç©å¼±ï¼Œä½†ç§‘æŠ€èˆ‡å•†æ¥­ç™¼é”ã€‚" },
        { t:["åœ‹å…«","ä¸­åœ‹å²"], e:"é´‰ç‰‡æˆ°çˆ­", y:"ä¸å¹³ç­‰æ¢ç´„", k:"å—äº¬æ¢ç´„", d:"ä¸­åœ‹è¿‘ä»£å²é–‹ç«¯ï¼Œç°½è¨‚ç¬¬ä¸€å€‹ä¸å¹³ç­‰æ¢ç´„å—äº¬æ¢ç´„ã€‚" },
        { t:["åœ‹å…«","ä¸­åœ‹å²"], e:"æ–‡åŒ–å¤§é©å‘½", y:"åå¹´æµ©åŠ«", k:"ç´…è¡›å…µ", d:"æ¯›æ¾¤æ±ç™¼å‹•çš„æ”¿æ²»é‹å‹•ï¼Œé€ æˆç¤¾æœƒå‹•ç›ªèˆ‡æ–‡åŒ–ç ´å£ã€‚" },

        // [åœ‹ä¹] ä¸–ç•Œå²
        { t:["åœ‹ä¹","ä¸–ç•Œå²"], e:"å°¼ç¾…æ²³æ–‡æ˜", y:"æ­»å¾Œå¯©åˆ¤", k:"é‡‘å­—å¡”", d:"ç›¸ä¿¡éˆé­‚ä¸æ»…ï¼Œè£½ä½œæœ¨ä¹ƒä¼Šèˆ‡é‡‘å­—å¡”ï¼Œç™¼å±•å¹¾ä½•å­¸ã€‚" },
        { t:["åœ‹ä¹","ä¸–ç•Œå²"], e:"å¸Œè‡˜åŸé‚¦", y:"æ°‘ä¸»æ”¿æ²»", k:"é›…å…¸", d:"é›…å…¸ç™¼å±•å‡ºç›´æ¥æ°‘ä¸»ï¼Œæ–¯å·´é”å‰‡ä»¥è»äº‹æ•™è‚²èåã€‚" },
        { t:["åœ‹ä¹","ä¸–ç•Œå²"], e:"æ–‡è—å¾©èˆˆ", y:"äººæ–‡ä¸»ç¾©", k:"é”æ–‡è¥¿", d:"ä»¥äººç‚ºæœ¬ï¼Œé‡æ–°ç™¼ç¾å¸Œè‡˜ç¾…é¦¬å¤å…¸æ–‡åŒ–ï¼Œå¼·èª¿ç¾ä¸–åƒ¹å€¼ã€‚" },
        { t:["åœ‹ä¹","ä¸–ç•Œå²"], e:"å·¥æ¥­é©å‘½", y:"è’¸æ°£æ©Ÿ", k:"å·¥å» åˆ¶åº¦", d:"ç“¦ç‰¹æ”¹è‰¯è’¸æ°£æ©Ÿï¼Œç”Ÿç”¢æ–¹å¼ç”±æ‰‹å·¥è½‰ç‚ºæ©Ÿæ¢°åŒ–ã€‚" },
        { t:["åœ‹ä¹","ä¸–ç•Œå²"], e:"æ³•åœ‹å¤§é©å‘½", y:"è‡ªç”±å¹³ç­‰åšæ„›", k:"æ‹¿ç ´å´™", d:"æ¨ç¿»å°ˆåˆ¶ç‹æ¬Šï¼Œç™¼è¡¨äººæ¬Šå®£è¨€ï¼Œå½±éŸ¿æ­æ´²æ°‘ä¸»ç™¼å±•ã€‚" },
        { t:["åœ‹ä¹","ä¸–ç•Œå²"], e:"å†·æˆ°", y:"ç¾è˜‡å°æŠ—", k:"éµå¹•", d:"äºŒæˆ°å¾Œè³‡æœ¬ä¸»ç¾©èˆ‡å…±ç”¢ä¸»ç¾©å…©å¤§é™£ç‡Ÿçš„å°å³™ã€‚" },

        // [é«˜ä¸­] å°ˆé¡Œ
        { t:["é«˜ä¸€","æ­·å²"], e:"å¤§èˆªæµ·æ™‚ä»£", y:"ç‰©ç¨®äº¤æ›", k:"å“¥å€«å¸ƒ", d:"æ­æ´²ç™¼ç¾æ–°èˆªè·¯ï¼Œé€£çµå…¨çƒè²¿æ˜“ï¼Œå°è‡´ç¾æ´²å¤æ–‡æ˜æ»…çµ•ã€‚" },
        { t:["é«˜äºŒ","æ­·å²"], e:"å•Ÿè’™é‹å‹•", y:"ç†æ€§ä¸»ç¾©", k:"ä¸‰æ¬Šåˆ†ç«‹", d:"å­Ÿå¾·æ–¯é³©æå‡ºä¸‰æ¬Šåˆ†ç«‹ï¼Œæ´›å…‹ä¸»å¼µå¤©è³¦äººæ¬Šã€‚" }
    ];

    historyDB.forEach((item, idx) => {
        const id = `hist_${idx}`;
        const tags = ["history", "æ­·å²", ...item.t];
        const func = () => {
            const others = Utils.shuffle(historyDB.filter(x => x.e !== item.e)).slice(0, 3);
            const opts = Utils.shuffle([item.y, ...others.map(x => x.y)]);
            return {
                question: `ã€${item.t[1]}ã€‘é—œæ–¼ã€Œ${item.e}ã€çš„æ­·å²ç‰¹å¾µï¼Œä¸‹åˆ—ä½•è€…æ­£ç¢ºï¼Ÿ`,
                options: opts,
                answer: opts.indexOf(item.y),
                concept: item.t[1],
                explanation: [`æ­£ç¢ºç­”æ¡ˆï¼š${item.y}`, `èªªæ˜ï¼š${item.d}`, `é—œéµè©ï¼š${item.k}`, Utils.getImg(item)],
                subject: "history",
                tags: tags
            };
        };
        func.subject = "history";
        func.tags = tags;
        window.__HISTORY_REPO__[id] = { func, tags, subject: "history" };
    });
})(window);
