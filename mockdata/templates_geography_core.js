(function(global){
  'use strict';
  console.log("🌐 Geography 500-generator starting...");

  window.__GEOGRAPHY_REPO__ = window.__GEOGRAPHY_REPO__ || {};

  const Utils = {
    rnd: (min, max) => Math.floor(Math.random() * (max - min + 1)) + min,
    pick: (arr) => arr[Math.floor(Math.random() * arr.length)],
    shuffle: (arr) => {
      const a = arr.slice();
      for (let i = a.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [a[i], a[j]] = [a[j], a[i]];
      }
      return a;
    },
    uid: (() => {
      let n = 0;
      return (prefix='geo') => `${prefix}_${Date.now().toString(36)}_${(n++).toString(36)}`;
    })()
  };

  // -------------------------
  // 基底題庫：多單元（每單元 6~10 題）
  // -------------------------
  const basePools = [
    // 台灣（延伸）
    { unitId:"tw_physical", unitName:"台灣—地形與氣候",grade: "國七", t:["台灣","地形","氣候"],
      items:[
        {q:"台灣主要山脈中，哪一條位於西側並與中央山脈平行？", a:"雪山山脈", o:["中央山脈","海岸山脈","阿里山山脈"]},
        {q:"台灣夏季午後常見的短時強降雨主要成因為何？", a:"地形抬升與午後對流", o:["海平面上升","地球自轉變慢","月相變化"]},
        {q:"台灣西部平原的形成主要與哪種作用有關？", a:"河流沖積與沉積", o:["火山噴發堆積","冰川搬運","海底隆起"]},
        {q:"台灣東部海岸常見的地形特徵為何？", a:"陡崖與狹窄海岸平地", o:["廣闊三角洲","沙漠化平原","廣大潟湖"]},
        {q:"台灣的主要降雨季節（梅雨）通常發生在何時？", a:"每年5-6月", o:["每年11-12月","每年2-3月","每年8-9月"]},
        {q:"台灣沿海紅樹林最常見於哪種環境？", a:"河口與潮間帶", o:["高山溪谷","內陸盆地","乾燥沙漠"]}
      ]
    },

    // 亞洲與中國
    { unitId:"asia_physical", unitName:"亞洲—自然與人文",grade: "國八", t:["亞洲","中國","地理"],
      items:[
        {q:"中國地勢呈現西高東低的三級階梯，最外側（第三階梯）主要為何種地形？", a:"東部平原與丘陵", o:["高原與盆地","高山與冰原","深海溝"]},
        {q:"印度季風帶來夏季降雨的主要原因是？", a:"海陸熱力差造成季風逆轉", o:["板塊俯衝","月球引力","太陽黑子活動"]},
        {q:"東南亞熱帶雨林區域的主要特徵為何？", a:"全年高溫多雨且生物多樣性高", o:["乾季長且降雨少","寒冷乾燥","高海拔冰川"]},
        {q:"中國黃土高原的土壤特性使其易發生哪種地表現象？", a:"嚴重水土流失與溝壑化", o:["珊瑚礁形成","火山噴發","冰川侵蝕"]},
        {q:"喜馬拉雅山脈的形成主要與哪兩塊板塊碰撞有關？", a:"印度板塊與歐亞板塊", o:["太平洋板塊與北美板塊","非洲板塊與南極板塊","澳洲板塊與太平洋板塊"]},
        {q:"東亞地區冬季常受哪一氣團影響導致寒冷乾燥？", a:"西伯利亞高壓（冷高壓）", o:["赤道低壓帶","副熱帶高壓","印度洋季風低壓"]}
      ]
    },

    // 歐洲
    { unitId:"europe", unitName:"歐洲地理",grade: "國九", t:["歐洲","氣候","人文"],
      items:[
        {q:"西歐溫和濕潤的氣候主要受哪一洋流與風帶影響？", a:"北大西洋暖流與西風帶", o:["寒流與信風","赤道逆流","極地東風"]},
        {q:"斯堪地那維亞半島以哪種地形與冰川遺跡著稱？", a:"冰蝕地形與峽灣", o:["沙漠與沙丘","火山口與熔岩平原","珊瑚礁"]},
        {q:"地中海型氣候的典型特徵是？", a:"夏乾冬雨", o:["夏雨冬乾","全年均勻降雨","極端寒冷"]},
        {q:"歐盟（EU）在地理上促進哪種跨國合作？", a:"經濟整合與自由貿易", o:["單一語言政策","統一宗教","統一貨幣在所有國家"]}
      ]
    },

    // 非洲
    { unitId:"africa", unitName:"非洲地理",grade: "國八", t:["非洲","氣候","資源"],
      items:[
        {q:"撒哈拉沙漠位於非洲的哪一部分？", a:"北非", o:["南非","東非","西非"]},
        {q:"剛果盆地的熱帶雨林對全球有何重要功能？", a:"碳吸存與生物多樣性保護", o:["增加海平面","製造沙漠","降低全球溫度至冰點"]},
        {q:"非洲大裂谷的形成與哪種構造活動有關？", a:"板塊張裂與地殼拉張", o:["板塊俯衝","海底擴張","隕石撞擊"]},
        {q:"撒哈拉以南非洲（撒赫爾）面臨的主要環境問題為何？", a:"乾旱化與土地退化", o:["冰川融化","海平面下降","火山爆發頻繁"]}
      ]
    },

    // 美洲
    { unitId:"americas", unitName:"美洲地理",grade: "國九", t:["美洲","地形","氣候"],
      items:[
        {q:"亞馬遜河流域的主要生態功能是？", a:"提供全球重要的碳匯與生物多樣性", o:["製造沙漠","形成冰川","提供大量石油"]},
        {q:"落基山脈主要位於哪一洲？", a:"北美洲", o:["南美洲","歐洲","亞洲"]},
        {q:"美國中西部廣闊平原適合哪種農業型態？", a:"商業性穀物與畜牧業", o:["熱帶雨林採集","高山梯田","漁業養殖"]},
        {q:"安第斯山脈的形成主要與哪種板塊互動有關？", a:"海洋板塊俯衝於大陸板塊之下", o:["板塊張裂","轉換斷層滑動","海底擴張"]}
      ]
    },

    // 大洋洲與極地
    { unitId:"oceania_polar", unitName:"大洋洲與兩極",grade: "國九", t:["大洋洲","兩極","氣候"],
      items:[
        {q:"澳洲內陸廣大的乾燥地帶稱為？", a:"澳洲內陸沙漠（Outback）", o:["亞馬遜盆地","撒哈拉沙漠","西伯利亞平原"]},
        {q:"南極洲的冰蓋對全球海平面有何影響？", a:"若大量融化會顯著提高海平面", o:["降低海平面","無影響","使地球自轉加速"]},
        {q:"大洋洲島國常面臨哪種氣候風險？", a:"海平面上升與風暴潮", o:["冰川形成","沙漠化","火山熔岩流"]},
        {q:"紐西蘭的地形與地震活動主要與哪種構造有關？", a:"板塊邊界與轉換斷層", o:["內陸沉降","海底擴張","極地冰蓋運動"]}
      ]
    },

    // 氣候與大氣
    { unitId:"climate", unitName:"氣候系統與變遷", grade: "國九",t:["氣候","大氣","變遷"],
      items:[
        {q:"溫室氣體增加會導致哪種全球現象？", a:"全球平均溫度上升（全球暖化）", o:["地球自轉停止","海平面下降","月球靠近地球"]},
        {q:"厄爾尼諾現象主要影響哪個海域的海溫與降雨？", a:"東太平洋赤道海域", o:["北大西洋","印度洋高緯區","地中海"]},
        {q:"氣候帶劃分常依據哪兩項主要氣候要素？", a:"溫度與降水分布", o:["海底地形與地震頻率","人口密度與語言","土壤酸鹼度與礦物"]},
        {q:"城市熱島效應主要由哪項造成？", a:"大量不透水面與建築密集", o:["海洋冷卻","森林增加","地震活動增加"]}
      ]
    },

    // 海洋與海岸
    { unitId:"ocean", unitName:"海洋科學與海岸", t:["海洋","潮汐","海岸"],
      items:[
        {q:"潮汐主要由哪兩個天體的引力共同影響？", a:"月球與太陽（以月球為主）", o:["火星與金星","木星與土星","地球與火星"]},
        {q:"洋流對氣候的影響主要透過什麼機制？", a:"輸送熱量與調節海表溫度", o:["改變地球自轉","改變地殼構造","改變月球軌道"]},
        {q:"珊瑚礁白化主要與哪項環境變化有關？", a:"海水溫度上升", o:["海水鹽度下降","海底火山爆發","海流速度增加"]},
        {q:"潮汐能發電的可行性主要取決於哪兩項？", a:"潮差大小與地形適宜性", o:["海水鹽度與海水顏色","海洋生物多樣性與漁業","海底火山活動與月相"]}
      ]
    },

    // 地形與岩石圈
    { unitId:"geomorph", unitName:"地形與岩石圈", t:["地形","岩石","地質"],
      items:[
        {q:"岩石循環包含哪三大類岩石？", a:"火成岩、沉積岩、變質岩", o:["玄武岩、石灰岩、頁岩","砂岩、頁岩、板岩","火山灰、熔岩、岩漿"]},
        {q:"褶皺與斷層主要由哪種地殼應力造成？", a:"擠壓與拉張應力", o:["風化應力","潮汐應力","生物作用"]},
        {q:"中洋脊主要與哪種板塊邊界有關？", a:"張裂型（海底擴張）", o:["俯衝型","轉換斷層型","穩定邊界"]},
        {q:"河流三角洲的形成主要與哪種過程有關？", a:"河流攜帶沉積物在入海口沉積", o:["火山噴發堆積","冰川搬運","地殼抬升"]}
      ]
    },

    // 人口、都市與經濟
    { unitId:"human_geo", unitName:"人文地理與經濟",grade: "高一", t:["人口","都市","經濟"],
      items:[
        {q:"人口金字塔可以顯示哪項人口特徵？", a:"年齡結構與生育率趨勢", o:["土壤類型","海水鹽度","地震頻率"]},
        {q:"都市化常帶來哪種環境問題？", a:"空氣污染與都市熱島效應", o:["增加森林覆蓋","降低人口密度","減少交通需求"]},
        {q:"比較利益理論主要用於解釋什麼？", a:"國際貿易中專業化與互惠交換的好處", o:["地震發生機制","氣候變遷原因","海洋潮汐形成"]},
        {q:"工業區位選擇常考量哪些要素？", a:"原料、交通、勞力與市場", o:["月相、星座、風水","海水溫度、鹽度、潮汐","語言、宗教、服飾"]}
      ]
    },

    // GIS、遙測與地圖
    { unitId:"gis_rs", unitName:"GIS 與遙測",grade: "高一", t:["GIS","遙測","地圖"],
      items:[
        {q:"地理資訊系統（GIS）最主要的功能是？", a:"儲存、分析與視覺化空間資料", o:["製造地震","控制天氣","生產農作物"]},
        {q:"遙測影像常用哪種指標評估植被健康？", a:"植被指數（NDVI）", o:["海水鹽度指數","地震指數","人口指數"]},
        {q:"等高線圖上等高線越密集代表什麼？", a:"坡度越陡", o:["坡度越緩","海拔越低","地形越平坦"]},
        {q:"麥卡托投影的主要缺點是？", a:"高緯度地區面積嚴重放大", o:["方向完全錯誤","無法表示經緯度","無法繪製海圖"]}
      ]
    },

    // 自然災害與風險管理
    { unitId:"hazards", unitName:"自然災害與風險管理",grade: "高一", t:["災害","風險","管理"],
      items:[
        {q:"地震預警系統主要利用哪種波的先到特性？", a:"P波先到", o:["S波先到","表面波先到","潮汐波先到"]},
        {q:"山坡地濫墾最可能引發哪種災害？", a:"土石流與山崩", o:["海嘯","颱風","火山爆發"]},
        {q:"洪水風險管理常用哪種工程與非工程措施結合？", a:"堤防建設與生態復育", o:["完全混凝土化河道","禁止所有人類活動","只靠保險賠償"]},
        {q:"海嘯主要由哪種地質事件引發？", a:"海底地震或海底滑坡", o:["颱風中心通過","潮汐變化","海水溫度上升"]}
      ]
    },

    // 永續與資源
    { unitId:"sustain", unitName:"永續發展與資源管理",grade: "國九", t:["永續","資源","環境"],
      items:[
        {q:"永續發展三大面向為何？", a:"經濟、社會、環境三者平衡", o:["科技、軍事、文化","教育、醫療、交通","政治、經濟、宗教"]},
        {q:"再生能源不包括下列哪一項？", a:"石油", o:["太陽能","風能","水力"]},
        {q:"水資源管理常用的非結構性措施為何？", a:"節水、回收與需求管理", o:["填海造陸","大量抽地下水","全面混凝土化河道"]},
        {q:"生態系服務的概念主要強調什麼？", a:"自然系統對人類提供的功能與利益", o:["自然系統的經濟價值不可衡量","自然系統只會造成災害","自然系統與人類無關"]}
      ]
    },
  // 台灣（延伸） 16 題
  { unitId:"tw_physical", unitName:"台灣—地形與氣候（延伸）", grade: "國七", t:["台灣","地形","氣候"],
    items:[
      {q:"台灣西部河川多呈分支或彎曲，這主要與哪種地形有關？", a:"沖積平原地形", o:["火山口地形","冰蝕谷地形","珊瑚礁地形"]},
      {q:"台灣東部常見的斷崖海岸主要是因為哪種地質作用？", a:"板塊擠壓抬升與海蝕作用", o:["冰川侵蝕","風成堆積","珊瑚堆積"]},
      {q:"台灣中部山區常見的溫差大，主要原因為何？", a:"海拔高度變化造成溫度垂直遞減", o:["海流冷卻效應","地球自轉變化","土壤鹽度差異"]},
      {q:"台灣北部冬季多陰雨，主要受哪一氣候系統影響？", a:"東北季風與西伯利亞冷高壓", o:["赤道低壓帶","副熱帶高壓","印度洋季風"]},
      {q:"台灣沿海潮間帶常見的生物指標為何？", a:"潮池中的海藻與貝類群落", o:["高山針葉林","沙漠仙人掌","冰川藻類"]},
      {q:"台灣火山活動較集中的地區為何處？", a:"北部與東北部的海底火山與玄武岩區", o:["中央山脈高峰","西部沖積平原","南部珊瑚礁"]},
      {q:"台灣地震頻繁的主要原因為何？", a:"位於板塊交界帶且板塊運動活躍", o:["火山噴發頻繁","海平面劇烈變化","月球引力異常"]},
      {q:"台灣西南沿海常見鹽田與潟湖，這類地形主要與何者有關？", a:"潮汐作用與淺海沉積", o:["冰川搬運","高山侵蝕","深海沉積"]},
      {q:"台灣山區土壤易流失，最有效的保育措施為何？", a:"植被復育與坡面保護", o:["大量開挖坡地","填海造陸","增加道路密度"]},
      {q:"台灣夏季午後雷陣雨常伴隨哪種對流現象？", a:"熱對流與垂直發展的積雨雲", o:["海霧形成","輻射霧穩定層","地震波動"]},
      {q:"台灣西部平原的地下水過度抽取會造成什麼問題？", a:"地層下陷與土壤鹽化", o:["冰川形成","海平面下降","火山爆發"]},
      {q:"台灣東北角海域的潮流與海蝕作用，常形成哪種海岸景觀？", a:"海蝕平台與海蝕洞穴", o:["廣闊沙灘","三角洲","潟湖"]},
      {q:"台灣高山地區的植被帶隨海拔變化，這種現象稱為？", a:"垂直帶序", o:["水平帶序","季節性遷徙","潮汐帶序"]},
      {q:"台灣沿海紅樹林對沿岸防護的功能為何？", a:"減緩波浪侵蝕並穩定泥沙", o:["增加海水鹽度","促進海平面上升","阻止所有漁業活動"]},
      {q:"台灣河川在颱風後常見的地形改變為何？", a:"河道沖刷與沖積扇改變", o:["冰川擴張","火山堆積","珊瑚礁形成"]},
      {q:"台灣東部海岸的地質景觀常被列為觀光資源，主要因為？", a:"斷層抬升與海蝕地形景觀獨特", o:["廣大沙漠景觀","高山冰川活動","大面積珊瑚礁平原"]}
    ]
  },

  // 亞洲與中國 16 題
  { unitId:"asia_physical", unitName:"亞洲—自然與人文（延伸）", grade: "國八", t:["亞洲","中國","地理"],
    items:[
      {q:"東南亞島嶼國家多為哪種地質來源？", a:"火山與珊瑚礁混合成因", o:["冰川堆積","大陸裂谷沉積","沙漠風成土"]},
      {q:"中國東部沿海經濟帶發展的地理優勢為何？", a:"港口與平原交通便利", o:["高山阻隔交通","極端寒冷氣候","缺乏淡水資源"]},
      {q:"印度季風帶來豐沛雨量，對農業最直接的影響是？", a:"支持稻作與季節性耕作", o:["形成永久冰蓋","使土壤鹽化","阻止所有植被生長"]},
      {q:"中國西部高原地區水資源分布不均，主要原因為何？", a:"地形高低與降水差異大", o:["海洋潮汐影響","火山噴發頻繁","城市化過度"]},
      {q:"亞洲內陸乾旱化加劇常與哪種人為活動有關？", a:"過度放牧與不當耕作", o:["海洋捕撈過度","冰川人工融化","火山爆發"]},
      {q:"東亞沿海的颱風路徑主要受哪項大尺度環流影響？", a:"副熱帶高壓與西風帶位置", o:["赤道逆流","月球潮汐","地殼抬升"]},
      {q:"中國長江流域的水利工程對下游影響可能包括？", a:"改變沉積與洪水頻率", o:["立即消除地震","使海平面下降","增加月球引力"]},
      {q:"亞洲高山冰川退縮會對哪些地區造成長期水資源壓力？", a:"下游季節性依賴融水的河流流域", o:["深海漁場","沙漠中心","極地內陸冰蓋"]},
      {q:"東南亞熱帶季風林與熱帶雨林的主要差異為何？", a:"季風林有明顯乾季，雨林全年濕潤", o:["季風林全年無雨","雨林位於高緯度","兩者無任何差異"]},
      {q:"中國黃河上游的泥沙含量高，主要來自哪種地貌？", a:"黃土高原的風成沉積物", o:["珊瑚礁崩解","冰川搬運","火山灰沉積"]},
      {q:"亞洲城市快速擴張常導致哪種環境問題？", a:"都市熱島與空氣污染加劇", o:["全球溫度立即下降","海平面普遍下降","增加冰川面積"]},
      {q:"喜馬拉雅山脈對南亞氣候的屏障作用主要表現為？", a:"阻擋冷空氣並影響季風路徑", o:["促進海洋暖流","增加赤道低壓","改變月相"]},
      {q:"東亞河流在冬季流量減少，主要是因為？", a:"降水減少與結冰或融水減少", o:["海水倒灌","火山噴發封河","地殼快速抬升"]},
      {q:"亞洲沿海的鹽沼與紅樹林對生態的貢獻為何？", a:"提供育幼棲地並穩定泥沙", o:["增加地震頻率","製造沙漠","降低海水鹽度"]},
      {q:"亞洲內陸盆地常見的氣候特徵為何？", a:"日夜溫差大且降雨稀少", o:["全年高濕度","常年冰雪覆蓋","海洋性氣候"]},
      {q:"亞洲某些地區的地表鹽鹼化會降低農業生產力，主要原因為？", a:"灌溉不當與蒸發導致鹽分累積", o:["火山灰覆蓋","冰川搬運","海水大量注入"]}
    ]
  },

  // 歐洲 16 題
  { unitId:"europe", unitName:"歐洲地理（延伸）", grade: "國九", t:["歐洲","氣候","人文"],
    items:[
      {q:"歐洲西岸溫帶海洋性氣候的特徵為何？", a:"冬暖夏涼且全年降雨分布較均勻", o:["極端乾燥","全年寒冷","夏季極端高溫"]},
      {q:"地中海沿岸的農業常以何種作物為主？", a:"橄欖、葡萄與柑橘類", o:["熱帶香蕉","高山馬鈴薯","海藻養殖"]},
      {q:"北歐國家普遍採用哪種能源政策以減少碳排放？", a:"發展再生能源與能效提升", o:["全面依賴煤炭","禁止再生能源","大量開採森林"]},
      {q:"歐洲平原對交通與經濟的影響主要是？", a:"促進內陸交通網絡與農業發展", o:["阻礙貿易","造成海嘯","使氣候極端化"]},
      {q:"阿爾卑斯山的融雪對周邊地區的影響為何？", a:"提供河川乾季水源但也可能引發洪水", o:["使海平面下降","增加沙漠面積","降低全球溫度"]},
      {q:"歐洲城市化歷程中常見的土地利用變化為何？", a:"農地轉為都市用地與交通設施擴張", o:["增加原始森林面積","形成永久冰蓋","消滅所有河流"]},
      {q:"英國受北大西洋暖流影響，氣候較同緯度地區溫和，這是因為？", a:"暖流輸送熱量並影響海洋與大氣循環", o:["地殼抬升","月球引力增強","地球自轉變慢"]},
      {q:"歐洲的河流航運優勢主要來自哪種地形特徵？", a:"河網密集且河道多為可航段", o:["高山峽谷多且河道狹窄","廣大沙漠阻隔","海底深溝多"]},
      {q:"地中海型氣候區的植被適應特徵為何？", a:"耐旱且葉片常為硬葉型", o:["需大量水分的薄葉型","耐寒針葉型","完全無葉植物"]},
      {q:"歐盟內部的交通整合主要促進哪種地理效應？", a:"跨國通勤與物流效率提升", o:["國家間語言統一","地震頻率降低","海平面上升"]},
      {q:"斯堪地那維亞的峽灣形成主要與哪種作用有關？", a:"冰川侵蝕與海水淹沒古河谷", o:["火山爆發堆積","沙漠風成作用","珊瑚礁生長"]},
      {q:"歐洲某些地區的土壤酸化問題常與哪種人為活動有關？", a:"工業排放與酸雨影響", o:["海洋潮汐變化","冰川融化","火山噴發"]},
      {q:"地中海沿岸城市在夏季面臨的主要環境挑戰為何？", a:"缺水與高溫熱浪", o:["永久冰雪覆蓋","全年暴雨","火山熔岩流"]},
      {q:"歐洲的文化景觀常與哪種地理因素密切相關？", a:"地形、河流與交通路網的歷史演化", o:["月相變化","海水鹽度","地球自轉速率"]},
      {q:"歐洲北部的苔原生態主要分布在何種環境？", a:"高緯度寒冷且短生長季的地帶", o:["熱帶雨林區","溫帶草原","沙漠地帶"]},
      {q:"歐洲沿海的港口城市多發展成為經濟中心，主要原因為？", a:"海運貿易與交通樞紐功能", o:["靠近火山口","位於高山頂端","受冰川保護"]}
    ]
  },

  // 非洲 16 題
  { unitId:"africa", unitName:"非洲地理（延伸）", grade: "國八", t:["非洲","氣候","資源"],
    items:[
      {q:"撒哈拉沙漠的形成主要與哪種氣候因素有關？", a:"副熱帶高壓帶與乾燥下沉氣流", o:["赤道低壓帶增強","海洋暖流輸送","冰川擴張"]},
      {q:"剛果盆地熱帶雨林的土壤通常為何特性？", a:"表土肥沃但易流失，底土貧瘠", o:["深厚黏土極肥沃","永久凍土","鹽鹼化土壤"]},
      {q:"非洲大裂谷帶的地質活動會帶來哪種資源優勢？", a:"地熱能與礦產資源潛力", o:["大量可耕耘平原","永久淡水湖泊","廣大珊瑚礁"]},
      {q:"撒赫爾地區的沙漠化加劇，最可能的社會影響為何？", a:"農牧生計受損與人口遷移", o:["冰川形成增加水源","海平面下降","地震頻率降低"]},
      {q:"非洲東部高原適合哪種農業型態？", a:"高地小農與季節性耕作", o:["熱帶雨林採集","大面積灌溉稻作","海洋養殖"]},
      {q:"非洲沿海的珊瑚礁對當地社區的好處為何？", a:"提供漁業資源與海岸保護", o:["增加地震頻率","製造沙漠","降低海水鹽度"]},
      {q:"非洲某些地區的水資源衝突常與哪項因素有關？", a:"跨界河流的分配與使用權", o:["月球引力變化","火山噴發","冰川擴張"]},
      {q:"非洲熱帶草原（薩凡納）常見的植被與動物互動特徵為何？", a:"季節性草地生長與大型草食動物遷徙", o:["永久森林覆蓋","冰川活動主導","海洋性漁業為主"]},
      {q:"北非沿海地區的地中海型氣候對農業的影響為何？", a:"冬季降雨支持冬小麥與橄欖栽培", o:["全年無降雨","全年冰雪覆蓋","全年高溫無雨"]},
      {q:"非洲內陸湖泊水位劇烈變化常與哪種因素有關？", a:"降雨變異與人為抽水使用", o:["海洋潮汐直接影響","火山熔岩封堵","月球軌道改變"]},
      {q:"非洲的礦產資源開採常帶來哪種環境問題？", a:"土壤與水體污染及生態破壞", o:["增加森林覆蓋","降低地震頻率","形成永久冰蓋"]},
      {q:"非洲熱帶雨林的保育對全球氣候重要，主要因為？", a:"大量碳吸存並維持水循環", o:["製造海嘯","降低地球自轉","增加月球引力"]},
      {q:"非洲西部沿海的河口三角洲常面臨哪種威脅？", a:"海平面上升與人為開發侵蝕", o:["冰川擴張","火山爆發覆蓋","永久乾旱消失"]},
      {q:"非洲某些地區的城市化快速擴張會造成什麼問題？", a:"基礎設施不足與環境污染", o:["永久增加森林面積","海平面下降","地震消失"]},
      {q:"非洲高原地區的氣候特徵通常為何？", a:"溫差大且降雨季節性明顯", o:["全年濕冷","永久冰雪","海洋性氣候"]},
      {q:"非洲沿海的熱帶風暴（若發生）對沿岸社區的主要威脅為？", a:"風暴潮與沿岸淹水", o:["冰川崩解","火山熔岩流","月球引力改變"]}
    ]
  },

  // 美洲 16 題
  { unitId:"americas", unitName:"美洲地理（延伸）", grade: "國九", t:["美洲","地形","氣候"],
    items:[
      {q:"亞馬遜流域的土壤普遍不如表面植被肥沃，主要原因為何？", a:"熱帶雨林的養分多集中於表層生物循環", o:["火山灰極度肥沃","冰川搬運帶來肥土","海洋鹽分沉積"]},
      {q:"落基山脈的形成與哪種板塊互動有關？", a:"太平洋板塊與北美板塊的複雜擠壓與俯衝", o:["印度板塊與歐亞板塊碰撞","非洲板塊張裂","南極板塊上升"]},
      {q:"美國中西部的黑土帶適合哪種作物？", a:"小麥與玉米等商業性穀物", o:["熱帶水果","高山作物","海藻養殖"]},
      {q:"中美洲與加勒比海地區地震與火山活動頻繁，主要因為？", a:"位於板塊邊界與島弧俯衝帶", o:["內陸穩定板塊","永久冰蓋活動","月球潮汐影響"]},
      {q:"安第斯山脈的高原地帶（如阿爾蒂普拉諾）適合何種生產活動？", a:"高山牧放與耐寒作物栽培", o:["熱帶稻作","大規模灌溉香蕉園","海洋捕撈"]},
      {q:"美洲西岸的加州地區常見乾旱與野火，主要與哪種氣候因子有關？", a:"副熱帶高壓與乾熱季風條件", o:["常年濕冷海流","永久冰雪覆蓋","海平面下降"]},
      {q:"密西西比河流域的沖積平原對美國經濟的貢獻為何？", a:"提供肥沃農地與內陸航運通道", o:["形成高山牧場","製造海嘯","增加冰川面積"]},
      {q:"加勒比海島國面臨颶風威脅時，最重要的防護措施為何？", a:"加強沿岸防波堤與避難計畫", o:["在內陸建造冰川","大量填海造陸","禁止所有漁業"]},
      {q:"北美大平原的形成主要與哪種地質或沉積作用有關？", a:"長期河流沉積與冰川後期沉積作用", o:["火山噴發堆積","海底擴張","隕石撞擊"]},
      {q:"美洲某些地區的城市群形成常與哪項因素有關？", a:"港口、交通樞紐與資源集中", o:["高山阻隔","永久冰蓋保護","海洋性漁業獨占"]},
      {q:"亞馬遜森林的砍伐會直接導致哪種區域性氣候變化？", a:"蒸散量減少與降雨減少", o:["月球距離縮短","地球自轉停止","海平面下降"]},
      {q:"美洲西岸的板塊俯衝帶常伴隨哪種地質災害？", a:"強震與火山爆發", o:["大規模冰川形成","海平面下降","沙漠化消失"]},
      {q:"南美東部的潘帕斯草原最適合哪種經濟活動？", a:"大規模畜牧與穀物生產", o:["熱帶雨林採集","高山梯田","海洋養殖"]},
      {q:"美洲高山地區的坡地農業常採用何種技術以防止土壤流失？", a:"梯田與等高耕作", o:["大面積裸露耕地","深度抽地下水","填海造陸"]},
      {q:"北美西岸的海洋暖流對氣候的影響為何？", a:"調節沿岸溫度使冬季較溫和", o:["使沿岸全年乾燥","增加冰川覆蓋","使海平面下降"]},
      {q:"美洲內陸的鹽湖或內陸盆地常見的成因為何？", a:"排水不良且蒸發量大導致鹽分累積", o:["海水直接注入","火山熔岩覆蓋","冰川搬運帶來鹽分"]}
    ]
  },

  // 大洋洲與極地 16 題
  { unitId:"oceania_polar", unitName:"大洋洲與兩極（延伸）", grade: "國九", t:["大洋洲","兩極","氣候"],
    items:[
      {q:"太平洋島國的珊瑚礁對海岸保護的功能為何？", a:"減弱波浪能量並保護海岸線", o:["增加地震頻率","製造沙漠","降低海水鹽度"]},
      {q:"澳洲內陸的土壤多為何種特性？", a:"貧瘠且含鐵氧化物呈紅色", o:["深厚黑土極肥沃","永久凍土","高鹽鹼土"]},
      {q:"紐西蘭的地形多樣性主要來自於哪種地質作用？", a:"板塊擠壓與造山運動", o:["海底擴張穿越陸地","冰川唯一形成","火山灰覆蓋整地"]},
      {q:"南極洲的冰蓋融化會首先影響哪種全球現象？", a:"全球海平面上升", o:["地球自轉停止","月球軌道改變","全球溫度立即下降"]},
      {q:"大洋洲島國淡水資源短缺常見的原因為何？", a:"島嶼面積小且地下水易受鹽化", o:["大量冰川融水供應","永久河流流經","地表大量淡水湖"]},
      {q:"澳洲的植物多具抗旱特性，常見適應包括？", a:"深根系、厚葉與休眠期", o:["薄弱根系與淺葉","需常年積雪","依賴海水灌溉"]},
      {q:"南極沿岸生物多樣性較高的原因為何？", a:"海洋生產力高且有豐富浮游生物", o:["內陸冰蓋提供棲地","高溫熱帶氣候","大量森林覆蓋"]},
      {q:"太平洋島國面臨海平面上升時，淡水資源最常見的威脅為何？", a:"地下水鹽化與淡水涵養區縮小", o:["冰川形成增加淡水","永久降雨增加","地殼抬升創造新淡水"]},
      {q:"大洋洲某些火山島的土壤肥沃，主要因為？", a:"火山灰提供礦物質養分", o:["冰川搬運帶來肥土","海水鹽分沉積","沙漠風成土"]},
      {q:"南極洲研究站選址常考量哪項因素？", a:"靠近海岸以便補給且避開冰裂隙", o:["位於內陸冰蓋中心","靠近活火山口","位於熱帶帶"]},
      {q:"澳洲沿海城市面臨海岸侵蝕時，常見的軟性防護措施為何？", a:"恢復或建立沙灘與濕地", o:["全面混凝土化海岸","填海造陸大量硬化","禁止所有漁業"]},
      {q:"大洋洲島嶼的生態脆弱性主要來自於？", a:"物種端emism高且外來種入侵影響大", o:["永久冰雪覆蓋","高山森林過度茂密","地震完全不存在"]},
      {q:"南極海域的浮冰消失會直接影響哪種生態過程？", a:"海洋生產力與食物網結構改變", o:["地殼抬升","月球引力改變","地球自轉停止"]},
      {q:"澳洲內陸的牧場管理若不當，最可能導致？", a:"土壤退化與沙漠化擴大", o:["冰川形成","海平面下降","火山爆發"]},
      {q:"大洋洲島國在面對極端氣候事件時，最重要的社會適應策略為何？", a:"強化社區避難與基礎設施韌性", o:["永久遷離所有居民","禁止所有經濟活動","大量開採森林"]},
      {q:"南極冰蓋下的古氣候紀錄主要由何者提供？", a:"冰芯中的氣泡與沉積物記錄", o:["海底珊瑚年輪","樹木年輪","火山灰層唯一提供"]}
    ]
  },

  // 氣候與大氣 16 題
  { unitId:"climate", unitName:"氣候系統與變遷（延伸）", grade: "國九", t:["氣候","大氣","變遷"],
    items:[
      {q:"溫室氣體中哪一種氣體在短期內對暖化效應較強但濃度較低？", a:"甲烷", o:["氮氣","氧氣","氦氣"]},
      {q:"厄爾尼諾現象發生時，東太平洋海溫變化通常為何？", a:"海溫上升", o:["海溫下降","無變化","海水鹽度急降"]},
      {q:"氣候模型常用來預測未來氣候，主要依賴哪類資料？", a:"溫室氣體排放情景與物理過程參數化", o:["月相變化","地震頻率","單一城市的溫度記錄"]},
      {q:"城市熱島效應會造成哪種夜間現象？", a:"夜間溫度較郊區高", o:["夜間溫度較郊區低","夜間降雨完全停止","夜間風速顯著增加"]},
      {q:"氣候帶的緯度分布主要受哪兩項因素控制？", a:"太陽輻射與大氣環流", o:["地殼構造與礦物分布","語言分布與文化","海洋生物多樣性"]},
      {q:"全球暖化導致海平面上升的兩大原因為何？", a:"冰蓋融化與海水熱膨脹", o:["月球靠近地球與地殼抬升","地球自轉加速與海流停止","火山噴發與地震頻繁"]},
      {q:"溫室氣體減量的國際機制常以何種方式鼓勵減排？", a:"碳交易與排放上限制度", o:["強制關閉所有工廠","禁止所有交通工具","立即停止農業活動"]},
      {q:"氣候變遷對海洋生態的直接影響不包括下列哪一項？", a:"使地球自轉停止", o:["海水溫度上升","海洋酸化","珊瑚白化"]},
      {q:"副熱帶高壓在夏季常導致哪種天氣型態？", a:"晴朗乾燥與高溫", o:["持續暴雨","極端寒冷","全年濕潤"]},
      {q:"溫室氣體濃度上升會改變哪些氣候變率？", a:"極端高溫事件頻率與強度增加", o:["月相週期改變","地震頻率下降","海底火山活動停止"]},
      {q:"氣候適應策略與減緩策略的主要差別為何？", a:"適應是應對影響，減緩是降低排放源頭", o:["兩者完全相同","適應只在城市使用","減緩只針對農業"]},
      {q:"高緯度地區變暖速度較快的現象稱為？", a:"極地放大效應", o:["赤道冷化效應","海洋緩衝效應","月球潮汐效應"]},
      {q:"氣候變遷可能改變病媒傳播，主要機制為何？", a:"溫度與降雨改變影響病媒生態與分布", o:["地殼抬升直接殺死病媒","月球引力消失","海平面下降消滅病媒"]},
      {q:"森林碳匯管理常見的措施包括？", a:"減少砍伐與推動再造林", o:["大量抽地下水","填海造陸","禁止所有農業"]},
      {q:"海洋吸收二氧化碳導致酸化，這會影響哪類生物最直接？", a:"以碳酸鈣構成外殼的生物（如貝類與珊瑚）", o:["所有陸地哺乳類立即死亡","樹木根系停止生長","鳥類羽毛變色"]},
      {q:"氣候監測中常用的指標不包括下列哪一項？", a:"地震波速", o:["平均溫度變化","降水量趨勢","海平面變化"]}
    ]
  },

  // 海洋與海岸 16 題
  { unitId:"ocean", unitName:"海洋科學與海岸（延伸）", t:["海洋","潮汐","海岸"],
    items:[
      {q:"潮汐能發電的潛力取決於潮差與哪項地形條件？", a:"潮汐通道的地形收斂性", o:["海水鹽度高低","海底生物多樣性","海水顏色"]},
      {q:"海洋熱含量增加會對氣候系統造成何種影響？", a:"延緩大氣升溫但增加極端天氣能量", o:["立即降低地球自轉","使月球遠離地球","消除所有風暴"]},
      {q:"海洋環流中的上升流區通常有何特徵？", a:"營養鹽豐富且生產力高", o:["完全無生物存在","海水溫度極低導致無生命","海水鹽度為零"]},
      {q:"珊瑚礁白化事件最常由哪種壓力觸發？", a:"海水溫度異常升高", o:["海水溫度急速下降到冰點","月球引力改變","地殼抬升"]},
      {q:"海岸侵蝕加劇時，軟性海岸管理的優點為何？", a:"維持生態功能並提供自然緩衝", o:["完全阻止海水進入","永久固定海岸線","消除所有風暴"]},
      {q:"海洋酸化會降低海水中哪種離子的可用性，影響貝類殼體形成？", a:"碳酸根離子", o:["鈉離子","鉀離子","氯離子"]},
      {q:"潮汐形成的主要驅動力是？", a:"月球與太陽的引力與地球自轉", o:["地殼抬升","海底火山爆發","風力唯一驅動"]},
      {q:"近岸赤潮現象通常與哪種因素有關？", a:"營養鹽過量與水溫條件", o:["地震頻率增加","月相改變","海底火山冷卻"]},
      {q:"海洋塑膠污染對生物的直接影響不包括？", a:"改變地球自轉速率", o:["誤食導致窒息或營養不良","微塑膠進入食物鏈","棲地物理破壞"]},
      {q:"海流對氣候的調節功能主要是透過？", a:"輸送熱量與調節海表溫度", o:["改變地殼構造","改變月球軌道","控制地震發生"]},
      {q:"潮汐預測對沿岸社區重要，主要用途為何？", a:"防災與航運安全規劃", o:["控制海水鹽度","改變海底地形","增加漁獲量必然"]},
      {q:"海洋生態系服務不包含下列哪一項？", a:"使地球自轉停止", o:["提供漁業資源","調節氣候","維持生物多樣性"]},
      {q:"海洋溫躍層的存在會影響哪種海洋過程？", a:"垂直混合與營養鹽輸送", o:["月球潮汐形成","地殼抬升","海平面下降"]},
      {q:"潮汐與風浪共同作用下，近岸沉積物運移會導致？", a:"沙灘侵蝕或堆積的動態變化", o:["永久形成冰川","海底火山消失","月球軌道改變"]},
      {q:"海洋監測中常用的遙測指標不包括？", a:"地震波速", o:["海表溫度（SST）","葉綠素濃度指標","海面高度異常"]},
      {q:"海洋保護區設立的主要目的是？", a:"保護生物多樣性並維持漁業資源", o:["禁止所有人類活動永久遷離","增加海平面","改變地球自轉"]}
    ]
  },

  // 地形與岩石圈 16 題
  { unitId:"geomorph", unitName:"地形與岩石圈（延伸）", t:["地形","岩石","地質"],
    items:[
      {q:"火成岩按形成位置可分為哪兩類？", a:"侵入岩與噴出岩", o:["沉積岩與變質岩","玄武岩與石灰岩","頁岩與砂岩"]},
      {q:"斷層活動會造成地表哪種明顯地形？", a:"斷層崖與地塹", o:["三角洲","珊瑚礁","冰蝕谷"]},
      {q:"河流的侵蝕能力受哪項因素影響最大？", a:"流速與坡度", o:["月相變化","地殼年齡","海水鹽度"]},
      {q:"中洋脊的海底擴張會產生哪種地質現象？", a:"新洋殼生成與海底山脊", o:["深海溝形成","高原抬升","冰川形成"]},
      {q:"變質作用會改變岩石的哪項特性？", a:"礦物組成與結構排列", o:["使岩石變為液體","改變月球軌道","增加海水鹽度"]},
      {q:"風成沙丘的形狀受哪項因素影響最大？", a:"風向與風速", o:["地震頻率","海平面高度","月相"]},
      {q:"河流三角洲的沉積物顆粒由粗到細的分布通常如何？", a:"近口粗、遠口細", o:["近口細、遠口粗","均勻分布","完全無沉積"]},
      {q:"地質年代測定常用哪種方法來估算岩石年齡？", a:"放射性同位素定年法", o:["月相計年法","海水鹽度測年","樹木年輪唯一法"]},
      {q:"山體隆起與侵蝕達到平衡時，地形會趨向於？", a:"穩定的坡度與河流網格", o:["永久冰蓋擴張","海平面下降","地殼消失"]},
      {q:"火山噴發物中最易被風遠距運輸的是？", a:"火山灰", o:["熔岩塊","大型火山岩塊","深部岩漿"]},
      {q:"地表風化作用不包括下列哪一項？", a:"地殼整體抬升", o:["化學風化","物理風化","生物風化"]},
      {q:"冰川侵蝕常形成哪種典型地形？", a:"U形谷與冰斗", o:["V形谷與沖積扇","三角洲","珊瑚礁"]},
      {q:"沉積岩的成因主要與哪種過程有關？", a:"沉積、壓實與膠結", o:["高溫熔融","地殼快速抬升","月球潮汐"]},
      {q:"地震震級與震度的差別在於？", a:"震級是能量大小，震度是地面感受強度", o:["兩者完全相同","震度是能量大小","震級是地面感受強度"]},
      {q:"海岸侵蝕與堆積的平衡會形成哪種穩定海岸形態？", a:"沙灘與沙洲動態平衡", o:["永久懸崖不變","冰川海岸","火山熔岩海岸唯一"]},
      {q:"地質構造中的背斜與向斜是由哪種應力造成？", a:"擠壓應力造成褶皺", o:["潮汐應力","風化應力","生物作用"]}
    ]
  },

  // 人口、都市與經濟 16 題
  { unitId:"human_geo", unitName:"人文地理與經濟（延伸）", grade: "國七", t:["人口","都市","經濟"],
    items:[
      {q:"人口成長率下降會對社會造成哪種長期挑戰？", a:"老年化與勞動力短缺", o:["永久增加出生率","立即消除失業","海平面下降"]},
      {q:"都市擴張導致農地流失，最直接的影響為何？", a:"糧食生產空間減少", o:["增加冰川面積","海平面下降","地震消失"]},
      {q:"比較利益理論強調國家間貿易的好處，主要基於何種概念？", a:"專業化生產與相對成本優勢", o:["絕對自給自足","完全禁止貿易","地震預測"]},
      {q:"城市交通規劃若忽視大眾運輸，可能導致？", a:"交通擁擠與空氣污染加劇", o:["森林覆蓋增加","地震頻率降低","海平面下降"]},
      {q:"人口金字塔呈現鐘形（中間寬、兩端窄）代表何種人口結構？", a:"穩定或緩慢成長的人口結構", o:["極速成長","快速衰退","完全無出生率"]},
      {q:"都市化過程中常見的社會問題不包括？", a:"增加公共綠地面積（通常是改善而非問題）", o:["貧民窟擴大","基礎設施不足","空氣與水污染"]},
      {q:"工業區位選擇中，若原料成本高但市場近，企業可能偏好？", a:"靠近市場以降低運輸成本", o:["遠離市場以節省土地","選擇高山地區","只考慮風水"]},
      {q:"全球化對地方經濟的正面效應可能為何？", a:"擴大市場與技術轉移", o:["立即消滅所有地方文化","使所有國家語言相同","消除所有貧富差距"]},
      {q:"城市熱島效應會對能源需求造成何種影響？", a:"夏季冷氣需求增加，能源消耗上升", o:["能源需求完全消失","冬季能源需求增加到零","海平面下降"]},
      {q:"人口遷移中的拉力因素通常包含？", a:"就業機會與較佳生活條件", o:["地震頻率增加","月球引力變化","永久冰雪覆蓋"]},
      {q:"都市群（都市圈）形成會帶來哪種經濟效應？", a:"規模經濟與產業集聚效應", o:["完全消滅所有產業","使地震消失","海平面下降"]},
      {q:"服務業在都市經濟中成長，通常代表什麼趨勢？", a:"經濟結構從製造轉向服務導向", o:["所有農業消失","地殼抬升","月球靠近地球"]},
      {q:"人口密度高的城市若缺乏綠地，可能造成？", a:"生活品質下降與健康風險增加", o:["地震頻率降低","海平面下降","永久涼爽氣候"]},
      {q:"城鄉差距縮小的政策通常包含哪些措施？", a:"改善交通連結與教育醫療資源", o:["禁止城市發展","增加邊境封鎖","消滅所有農業"]},
      {q:"跨國企業選址時常考量的要素不包括？", a:"月相", o:["市場規模","勞動成本","法規環境"]},
      {q:"都市更新計畫若忽略社區參與，最可能導致？", a:"原住民或弱勢群體被迫遷移", o:["增加森林覆蓋","海平面下降","地震消失"]}
    ]
  },

  // GIS、遙測與地圖 16 題
  { unitId:"gis_rs", unitName:"GIS 與遙測（延伸）", grade: "高一", t:["GIS","遙測","地圖"],
    items:[
      {q:"NDVI 指標高代表植被狀況如何？", a:"綠色植被覆蓋良好且生長旺盛", o:["植被稀少","海水污染嚴重","地震頻繁"]},
      {q:"遙測影像的光譜解析度指的是？", a:"影像能分辨不同波段的能力", o:["影像的時間間隔","影像的檔案大小","影像的地理座標系"]},
      {q:"GIS 中的屬性資料主要儲存哪類資訊？", a:"地物的非空間性質如名稱與數值", o:["地球自轉速率","海水鹽度","月相"]},
      {q:"等高線圖上封閉的等高線代表什麼地形？", a:"山峰或盆地（視等高線高低而定）", o:["海洋深溝","永久冰蓋","沙漠唯一"]},
      {q:"地圖比例尺為 1:100000 表示什麼？", a:"地圖上 1 單位代表實地 100000 同單位距離", o:["地圖上 100000 單位代表實地 1 單位","地圖無法表示距離","地圖只顯示經緯度"]},
      {q:"遙測在災害應變中的應用不包括？", a:"直接改變地震發生時間", o:["災區範圍監測","洪水淹沒範圍估算","火災熱點偵測"]},
      {q:"GIS 空間分析中常用的緩衝區分析主要用途為何？", a:"評估距離影響範圍與鄰近關係", o:["改變地形高度","控制氣候帶分布","增加人口密度"]},
      {q:"投影變形不可避免時，地圖製作者通常會如何處理？", a:"根據用途選擇最適合的投影以最小化關鍵變形", o:["完全不使用投影","改變地球形狀","使地圖無比例尺"]},
      {q:"遙測影像的時間解析度指的是？", a:"同一地區影像重訪的頻率", o:["影像的色彩深度","影像的空間解析度","影像的檔案格式"]},
      {q:"GIS 中的疊圖分析（overlay）主要用於？", a:"整合多種空間資料以分析關聯性", o:["改變地球自轉","製造海嘯","消除地形"]},
      {q:"全球定位系統（GPS）定位精度受哪項因素影響？", a:"衛星幾何配置與遮蔽干擾", o:["海水鹽度","地殼年齡","月相"]},
      {q:"遙測資料在土地利用分類時常用哪種方法？", a:"監督式或非監督式分類演算法", o:["直接人工目視判讀唯一","月相分類法","地震分類法"]},
      {q:"地理資料的元資料（metadata）主要功能為何？", a:"描述資料來源、時間與品質以利使用", o:["改變資料內容","增加地震頻率","控制氣候"]},
      {q:"等高線間距越大代表坡度如何？", a:"坡度較緩", o:["坡度較陡","海拔越高","地形越平坦"]},
      {q:"遙測影像在監測森林砍伐時常用哪種指標？", a:"植被指數變化與土地覆蓋分類", o:["海水溫度變化","地震波速","月相變化"]},
      {q:"GIS 在城市規劃中的應用不包括？", a:"直接改變地震發生", o:["交通流量模擬","土地適宜性分析","基礎設施規劃支援"]}
    ]
  },

  // 自然災害與風險管理 16 題
  { unitId:"hazards", unitName:"自然災害與風險管理（延伸）", grade: "高一", t:["災害","風險","管理"],
    items:[
      {q:"地震發生時，建築物抗震設計最重要的考量為何？", a:"延性設計與能量耗散能力", o:["完全剛性結構","增加建築高度以避震","使用易碎材料"]},
      {q:"土石流發生前常見的徵兆不包括？", a:"月相變化", o:["地表裂縫出現","地下水位上升","小規模滑動或沉降"]},
      {q:"洪水風險管理中，非工程措施的優點為何？", a:"成本較低且可提升社區韌性", o:["完全消除洪水","使地震消失","永久阻止降雨"]},
      {q:"颱風預報中常用的參數不包括？", a:"地殼年齡", o:["中心氣壓","最大持續風速","移動路徑"]},
      {q:"火山噴發警戒時，最先應採取的公共安全措施為何？", a:"疏散高風險區域與建立避難所", o:["增加旅遊活動","填海造陸","禁止所有農業"]},
      {q:"地震預警系統能提供的主要好處是？", a:"在地震波到達前提供短暫警示以減少傷害", o:["完全預防地震發生","使海平面下降","改變月球軌道"]},
      {q:"山坡地植被破壞會增加哪種災害風險？", a:"土石流與坡面崩塌", o:["海嘯形成","颱風生成","火山爆發"]},
      {q:"海嘯預警系統的關鍵要素不包括？", a:"即時海面高度監測與通報機制", o:["月相預測","地震監測","疏散路線規劃"]},
      {q:"都市防災中，社區避難演練的主要目的為何？", a:"提升居民應變能力與熟悉避難程序", o:["永久遷離社區","消除所有災害","增加建築高度"]},
      {q:"氣候變遷可能增加哪些型態的自然災害風險？", a:"極端降雨、乾旱與熱浪頻率增加", o:["地球自轉停止","月球消失","火山活動完全停止"]},
      {q:"災害風險評估中常用的三要素為何？", a:"危險、暴露與脆弱性", o:["月相、星座、風水","海水鹽度、溫度、顏色","地震、火山、颱風唯一"]},
      {q:"沿海社區面對海平面上升的長期策略不包括？", a:"完全忽視並不採取任何行動", o:["退縮策略（撤離高風險區）","建設防波堤與濕地復育","調整土地使用與規劃"]},
      {q:"災害應變中的「黃金救援時間」概念主要強調？", a:"在災後短時間內救援可大幅降低死亡率", o:["救援可以無限期延後","救援只需在一年後進行","救援會使災害消失"]},
      {q:"地震後的次生災害常見為何？", a:"火災、土石流與海嘯（若近海）", o:["月球引力改變","永久冰川形成","海平面下降"]},
      {q:"社區韌性提升的關鍵措施之一為？", a:"建立多元備援系統與社區互助網絡", o:["禁止社區活動","消除所有基礎設施","永久遷離所有居民"]},
      {q:"災害風險溝通中，最重要的原則為何？", a:"資訊即時、清楚且可行", o:["故意模糊資訊以避免恐慌","只在災後才通報","只向少數人透露資訊"]}
    ]
  },

  // 永續與資源 8 題（剩餘題數）
  { unitId:"sustain", unitName:"永續發展與資源管理（延伸）", grade: "國九", t:["永續","資源","環境"],
    items:[
      {q:"永續城市規劃中常見的策略不包括？", a:"增加綠地與推動大眾運輸", o:["全面禁止所有經濟活動","增加私人車輛使用","消除公共空間"]},
      {q:"再生能源發展的主要挑戰之一為何？", a:"間歇性供電與儲能需求", o:["能源永遠免費","完全無需投資","立即消除所有污染"]},
      {q:"水資源永續管理中，需求管理的重點為何？", a:"減少浪費並提高用水效率", o:["大量抽地下水以滿足需求","禁止所有農業用水","填海造陸增加用水"]},
      {q:"生態系服務評估常用於何種決策？", a:"土地利用規劃與保育優先順序設定", o:["改變地球自轉","控制月相","消除所有經濟活動"]},
      {q:"循環經濟中「設計以便回收」的概念主要目的是？", a:"減少廢棄物並提高資源再利用率", o:["增加一次性產品使用","禁止回收活動","增加原料開採"]},
      {q:"可持續漁業管理的核心措施不包括？", a:"無限制捕撈以最大化短期收益", o:["設定捕撈配額與保護育幼場","監測漁獲與執法","推動漁業社區參與管理"]},
      {q:"氣候正義（climate justice）關注的重點為何？", a:"弱勢族群在氣候影響與減緩責任上的公平性", o:["只關心富國利益","忽視人權","只討論技術問題"]},
      {q:"永續發展目標（SDGs）強調的核心精神為？", a:"經濟、社會與環境三者兼顧的整合發展", o:["只追求經濟成長","只保護環境不顧人類","只強調軍事發展"]}
      ]
  }
];



  // -------------------------
  // 補充干擾選項池（增加多樣性）
  // -------------------------
  const extraDistractors = [
    "地形變化","氣候帶","人口密度","經緯度","海拔高度","河流流域","沉積作用",
    "板塊擠壓","海洋性氣候","大陸性氣候","季風","信風","西風","赤道低壓帶",
    "溫帶海洋性","地中海型","熱帶雨林","溫帶季風","高緯度","低緯度",
    "城市化","工業化","農業化","全球化","資源枯竭","生物多樣性"
  ];
function makeVariant(baseItem, unit) {
    const qBase = baseItem.q;
    const a = baseItem.a;
    const oList = (baseItem.o || []).slice();

    let q = qBase;
    const grade = unit.grade || "通用"; // 取得該單元的正確年級

    // 隨機決定是否在題幹標註年級
    if (Math.random() < 0.3) {
      const variantLabel = Utils.pick(["（例題）", "（應用）", "（延伸）"]);
      q = `${qBase} ${variantLabel}（適用：${grade}）`;
    }

    const distractors = oList.slice();
    while (distractors.length < 3) {
      const cand = Utils.pick(extraDistractors);
      if (cand !== a && !distractors.includes(cand)) distractors.push(cand);
    }

    const options = Utils.shuffle([a, ...distractors.slice(0, 3)]);
    const tags = ["geography", "地理", grade, ...unit.t];

    return {
      id: Utils.uid('geo'),
      question: `【地理】${q}`,
      options: options,
      answer: options.indexOf(a),
      explanation: [`正確答案：${a}`, `單元：${unit.unitName}`, `難度設定：${grade}`],
      subject: "geography",
      tags: tags
    };
  }

  function generateGeographyBank(targetCount = 500) {
    const bank = [];
    const baseList = [];

    basePools.forEach(unit => {
      unit.items.forEach(item => {
        // 確保將 grade 傳入 baseList
        baseList.push({
          unitId: unit.unitId,
          unitName: unit.unitName,
          grade: unit.grade,
          t: unit.t,
          item: item
        });
      });
    });

    if (baseList.length === 0) return bank;

    let idx = 0;
    while (bank.length < targetCount) {
      const entry = baseList[idx % baseList.length];
      // 這裡將正確的單元資訊（含年級）傳給生成器
      const variant = makeVariant(entry.item, {
        unitId: entry.unitId,
        unitName: entry.unitName,
        grade: entry.grade,
        t: entry.t
      });

      bank.push(variant);
      idx++;
    }
    return bank;
  }

  function injectToRepo(bank) {
    bank.forEach((item, i) => {
      const id = `geo_q_${i}`;
      window.__GEOGRAPHY_REPO__[id] = {
        func: () => ({
          question: item.question,
          options: item.options,
          answer: item.answer,
          explanation: item.explanation,
          subject: item.subject,
          tags: item.tags
        }),
        tags: item.tags,
        subject: item.subject
      };
    });
  }

  const TARGET = 500;
  const bank = generateGeographyBank(TARGET);
  injectToRepo(bank);

  global.__GEOGRAPHY_BANK__ = bank;
  global.generateGeographyBank = generateGeographyBank;

  console.log(`✅ 修正成功！共產生 ${bank.length} 題。`);
  console.log(`📌 年級分配檢查：`, bank[0].tags); // 觀察第一個產出的標籤是否包含正確年級

})(window);
