<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<title>è§£é¡Œè«–å£‡ï½œé›²ç«¯å­¸é™¢</title>

<!-- Tailwind -->
<script src="https://cdn.tailwindcss.com"></script>

<!-- Icons / Font -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap" rel="stylesheet">

<!-- Markdown -->
<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

<style>
body { font-family: 'Noto Sans TC', sans-serif; background:#f4f6f8; }

.sidebar-item{
    display:flex;align-items:center;gap:.75rem;
    padding:.75rem 1rem;border-radius:.75rem;
    color:#4b5563;transition:.2s;
}
.sidebar-item:hover{background:#f3f4f6}
.sidebar-item.active{
    background:#eff6ff;color:#2563eb;
    font-weight:700;box-shadow:inset 4px 0 0 #2563eb;
}
.ai-card{
    background:linear-gradient(135deg,#f0f9ff,#e0f2fe);
    border-left:4px solid #0ea5e9;
}
.typing-dot{animation:typing 1.4s infinite ease-in-out both}
.typing-dot:nth-child(1){animation-delay:-.32s}
.typing-dot:nth-child(2){animation-delay:-.16s}
@keyframes typing{
    0%,80%,100%{transform:scale(0)}
    40%{transform:scale(1)}
}
.markdown-body ul{list-style:disc;margin-left:1.5rem}
.markdown-body p{margin-bottom:.5rem}
</style>
</head>

<body class="h-screen flex overflow-hidden">

<!-- Sidebar -->
<aside class="w-64 bg-white border-r hidden lg:flex flex-col">
    <div class="h-16 flex items-center px-6 border-b font-bold text-xl">
        <span class="w-8 h-8 bg-blue-600 text-white rounded flex items-center justify-center mr-2">ç¿°</span>
        é›²ç«¯å­¸é™¢
    </div>

    <div class="p-6 text-center">
        <div class="w-14 h-14 mx-auto bg-blue-100 rounded-full flex items-center justify-center text-xl text-blue-600 mb-2">
            <i class="fas fa-user-graduate"></i>
        </div>
        <div id="userName" class="font-bold">æ—ç‚«éŠ“</div>
        <div class="text-xs text-gray-500">åœ‹ä¹</div>
    </div>

    <nav class="px-4 space-y-1 flex-grow text-sm">
        <a class="sidebar-item" href="#">ğŸ“š èª²ç¨‹ç¸½è¦½</a>
        <a class="sidebar-item" href="#">ğŸ©¹ éŒ¯é¡Œè£œæ•‘</a>
        <a class="sidebar-item" href="#">ğŸ“Š å­¸ç¿’åˆ†æ</a>
        <a class="sidebar-item active" href="#">ğŸ’¬ è§£é¡Œè«–å£‡</a>
    </nav>

    <div class="p-4 border-t text-center text-xs text-gray-400">
        Demo Version
    </div>
</aside>

<!-- Main -->
<main class="flex-grow flex flex-col">

<header class="h-16 bg-white border-b flex items-center justify-between px-6">
    <h2 class="font-bold text-lg flex items-center gap-2">
        <i class="fas fa-comments text-blue-500"></i> è§£é¡Œè«–å£‡
    </h2>
    <button onclick="toggleForm()" class="bg-blue-600 text-white px-5 py-2 rounded font-bold">
        æˆ‘è¦ç™¼å•
    </button>
</header>

<section class="flex-grow overflow-y-auto p-6">
<div class="max-w-3xl mx-auto space-y-6 pb-24">

<!-- ç™¼å•è¡¨å–® -->
<div id="postForm" class="hidden bg-white p-6 rounded shadow">
    <h3 class="font-bold mb-3">å»ºç«‹æ–°æå•</h3>
    <input id="postTitle" class="w-full p-3 border rounded mb-3 font-bold"
        placeholder="æ¨™é¡Œï¼šä¾‹å¦‚ é«˜ä¸­å¾®åˆ†å•é¡Œ">
    <textarea id="postContent" class="w-full p-3 border rounded h-28 mb-3"
        placeholder="è«‹æè¿°ä½ çš„å•é¡Œ"></textarea>
    <div class="flex justify-between">
        <span class="text-xs text-gray-400">
            <i class="fas fa-robot text-blue-500"></i> AI åŠ©æ•™å³æ™‚åˆ†æ
        </span>
        <button onclick="addPost()" class="bg-blue-600 text-white px-6 py-2 rounded font-bold">
            ç™¼ä½ˆ
        </button>
    </div>
</div>

<!-- è²¼æ–‡ -->
<div id="postList" class="space-y-6"></div>

<!-- AI thinking -->
<div id="aiThinking" class="hidden bg-white p-4 rounded shadow flex items-center gap-3 w-fit mx-auto">
    <i class="fas fa-robot text-indigo-600"></i>
    <div class="flex gap-1">
        <div class="w-2 h-2 bg-indigo-400 rounded-full typing-dot"></div>
        <div class="w-2 h-2 bg-indigo-400 rounded-full typing-dot"></div>
        <div class="w-2 h-2 bg-indigo-400 rounded-full typing-dot"></div>
    </div>
    <span class="text-xs text-gray-500">AI åŠ©æ•™åˆ†æä¸­...</span>
</div>

</div>
</section>
</main>

<script>
/* ===== å‡ AI åŠ©æ•™ ===== */
const RealAITutor = {
    name:"AI åŠ©æ•™",
    async askGemini(title,content){
        await new Promise(r=>setTimeout(r,1200));
        return `
### ğŸ“Œ é¡Œç›®é‡é»
- ${title}

### âŒ å¸¸è¦‹éŒ¯èª¤
- åªèƒŒå…¬å¼ï¼Œæ²’ç†è§£æ„ç¾©
- å–®ä½æˆ–ç¬¦è™Ÿæ··æ·†

### âœ… æ­£ç¢ºè§€å¿µ
- å…ˆç†è§£é¡Œæ„ï¼Œå†é¸æ“‡å…¬å¼
- æª¢æŸ¥æ¯ä¸€æ­¥æ¨ç†

ğŸ‘‰ è‹¥éœ€è¦ï¼Œæˆ‘å¯ä»¥å†å‡ºä¸€é¡Œé¡ä¼¼ç·´ç¿’çµ¦ä½ 
`;
    }
};

const dbKey="forum_posts";

function toggleForm(){
    postForm.classList.toggle("hidden");
}

function loadPosts(){
    const posts=JSON.parse(localStorage.getItem(dbKey)||"[]");
    postList.innerHTML="";
    posts.reverse().forEach(renderPost);
}

function renderPost(p){
    const replyHTML=p.reply?`
    <div class="mt-4 p-4 rounded border ai-card flex gap-3">
        <i class="fas fa-robot text-indigo-600"></i>
        <div class="markdown-body text-sm">${marked.parse(p.reply)}</div>
    </div>`:
    `<div class="mt-4 text-xs text-gray-400">ç­‰å¾…å›è¦†ä¸­â€¦</div>`;

    postList.insertAdjacentHTML("beforeend",`
    <div class="bg-white p-6 rounded shadow">
        <div class="font-bold text-lg">${p.title}</div>
        <div class="text-xs text-gray-500 mb-2">${p.author}ï½œ${p.date}</div>
        <div class="text-sm text-gray-700">${p.content}</div>
        ${replyHTML}
    </div>`);
}

async function addPost(){
    const t=postTitle.value.trim();
    const c=postContent.value.trim();
    if(!t||!c) return alert("è«‹å¡«å¯«å®Œæ•´å…§å®¹");

    const post={
        id:Date.now(),
        title:t,
        content:c,
        author:"æ—ç‚«éŠ“",
        date:new Date().toLocaleString(),
        reply:null
    };

    const posts=JSON.parse(localStorage.getItem(dbKey)||"[]");
    posts.push(post);
    localStorage.setItem(dbKey,JSON.stringify(posts));

    postTitle.value=postContent.value="";
    toggleForm();
    loadPosts();

    aiThinking.classList.remove("hidden");
    const ai=await RealAITutor.askGemini(t,c);
    post.reply=ai;
    localStorage.setItem(dbKey,JSON.stringify(posts));

    aiThinking.classList.add("hidden");
    loadPosts();
}

loadPosts();
</script>

</body>
</html>
